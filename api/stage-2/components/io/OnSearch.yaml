properties:
  context:
    allOf:
      - properties:
          domain:
            $ref: '../enum/index.yaml#/Domain'
      - properties:
          location:
            properties:
              country:
                allOf:
                  - $ref: '../enum/index.yaml#/Country'
                  - required:
                    - code
            required:
              - country
      - required:
        - domain
        - action
        - location
        - version
        - bpp_id
        - bpp_uri
        - transaction_id
        - message_id
        - timestamp
  message:
    allOf:
      - properties:
          catalog:
            properties:
              fulfillments:
                items:
                  properties:
                    type:
                      $ref: '../enum/index.yaml#/Fulfillment'
                  required:
                    - id
                    - type
                minLength: 1
      # add enum for provider fulfillment types
      - properties:
          catalog:
            properties:
              providers:
                properties:
                  fulfillments:
                    items:
                      properties:
                        type:
                          $ref: '../enum/index.yaml#/Fulfillment'
                      required:
                        - id
                        - type
                    minLength: 1
      - properties:
          catalog:
            allOf:
              - properties:
                  providers:
                    items:
                      properties:
                        items:
                          items:
                            required:
                              - id
                              - price
                          minLength: 1
                      required:
                        - id
                        - items
                    minLength: 1
              - required:
                  - providers
